# 部署后检查清单

## ✅ 构建阶段（已完成）

从日志看，依赖安装成功：
- ✅ python-telegram-bot 22.5 已安装
- ✅ pytz 2025.2 已安装
- ✅ 所有依赖项都已满足

**注意：** 警告信息 "Running pip as the 'root' user" 是正常的，在容器环境中可以忽略。

---

## 🔍 部署后检查步骤

### 1. 检查环境变量

在 Zeabur Dashboard 中确认以下环境变量已设置：

```
✅ BOT_TOKEN=你的机器人Token
✅ ADMIN_USER_IDS=你的用户ID
✅ DATA_DIR=/data  (如果使用持久化存储)
```

### 2. 检查 Volume（持久化存储）

如果配置了持久化存储：
- ✅ Volume 已创建
- ✅ Mount Path: `/data`
- ✅ Size: 至少 1GB

### 3. 查看运行日志

在 Zeabur Dashboard 的 "Logs" 标签页，应该看到：

```
✅ 机器人启动中...
✅ 数据库已就绪
✅ 机器人已启动，等待消息...
```

### 4. 测试机器人

在 Telegram 中测试：

1. **私聊测试**
   - 发送 `/start`
   - 应该收到欢迎消息和当前流动资金信息

2. **群组测试**
   - 在群组中发送 `/create S01 A 5000`
   - 应该收到完整的订单创建消息（英语）

3. **快捷操作测试**
   - 在订单群中发送 `+1000`
   - 应该收到 `✅ Success`

---

## ⚠️ 常见问题

### 问题1：机器人无法启动

**检查：**
- 环境变量是否正确设置
- BOT_TOKEN 是否有效
- 查看日志中的错误信息

**解决方案：**
```
# 在日志中查找错误
# 常见错误：
- "BOT_TOKEN 未设置" → 检查环境变量
- "InvalidToken" → Token 无效，重新获取
- "ADMIN_USER_IDS 未设置" → 添加环境变量
```

### 问题2：数据库初始化失败

**检查：**
- DATA_DIR 环境变量是否正确
- Volume 是否正确挂载

**解决方案：**
```
# 如果使用持久化存储
DATA_DIR=/data

# 如果不使用持久化存储（测试）
# 可以不设置 DATA_DIR，使用默认路径
```

### 问题3：权限错误

**检查：**
- ADMIN_USER_IDS 是否包含你的用户ID
- 用户ID 格式是否正确（数字，多个用逗号分隔）

**解决方案：**
```
# 正确格式
ADMIN_USER_IDS=123456789,987654321

# 错误格式（有空格）
ADMIN_USER_IDS=123456789, 987654321  ❌
```

---

## 📊 验证部署成功

### 成功标志：

1. ✅ 构建完成，没有错误
2. ✅ 容器运行中（Status: Running）
3. ✅ 日志显示 "机器人已启动，等待消息..."
4. ✅ 可以收到 `/start` 命令的回复
5. ✅ 可以创建订单

### 如果所有检查都通过：

🎉 **部署成功！** 机器人已正常运行。

---

## 🔄 后续操作

1. **监控运行**
   - 定期查看日志
   - 检查是否有错误

2. **数据备份**
   - 如果使用 Volume，定期备份数据库文件
   - 或考虑迁移到 PostgreSQL

3. **更新代码**
   - 推送代码到 GitHub
   - Zeabur 会自动重新部署

---

## 📝 日志示例（正常启动）

```
🤖 机器人启动中...
📋 管理员数量: 1
📦 检查数据库...
✅ 数据库已就绪
✅ 机器人已启动，等待消息...
```

如果看到这些信息，说明部署成功！

